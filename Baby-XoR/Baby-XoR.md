# [S4CTF 2021](https://s4ctf.peykar.io):Baby-XoR

**Category:** Cryptography

**Description:** The first technique one should learn, in order to enter the fun world of modern cryptography, is XoR. Have you learned it well?

The challenge code is:
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from flag import flag

def xor(u, v):    
	return ''.join(chr(ord(cu) ^ ord(cv)) for cu, cv in zip(u, v))

u = flag
v = flag[1:] + flag[0]

enc = open('flag.enc', 'w')
enc.write(xor(u, v))
enc.close()
```
And we have a binary [file](flag.enc) containing some binary data which is generated by the code above

## solution overview

Ok we have some known binary data produced by this line of code(xor function):
```python
''.join(chr(ord(cu) ^ ord(cv)) for cu, cv in zip(u, v))
```
As you can see `u` and `v` in `zip(u, v)` are produced by these lines of code:
```python
u = flag
v = flag[1:] + flag[0]
```
This simply means if we have a flag like this `S4CTF{some_l33t_string_l1k3_7hi5}` the `u` is the flag itself and `v` is being produced by cutting the first character of the flag and moving it to the end: `4CTF{some_l33t_string_l1k3_7hi5}S`

## what is the xor function doing?

The xor function in a loop takes the nth character of `u` and the nth character of `v` (i mean ascii code) and XOR-s them together and finally joins the whole result. in the case of above flag the xor function will first XOR 'S' and '4' together and then XOR '4' and 'C' together and so on.
Ok now we know how the xor function works let's cut to the chase.

## Flag

the flag definitely contains these characters:`S4CTF{` so by performing the xor function on these characters we'll arrive at this result: `gw^W^R=` now if you take a look at this [file](flag.enc) you will notice this pattern in the middle. so as you might guess the flag looks like this:`some dummy string S4CTF{...}`

The key point for solving this challenge is that if we have two numbers let's say `A` and `B` if `A xor B = C => A xor C = B` so by knowing this we can solve the challenge using the script below:
```python

file = open('flag.enc', 'rb')

flag = file.read()
file.close()

flag = flag[13:] + flag[0:13] 


temp = ord('S')

for i in range(len(flag)):
    print(chr(temp),end='')
    temp = temp ^ flag[i]
```

and finaly the flag is:
`S4CTF{XOR_x0r_XoR_X0r_xOr!!!}`
